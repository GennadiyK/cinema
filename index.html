<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css"/>
</head>
<body>

<div class="container-fluid">
    <div id="alert" class="alert alert-success" role="alert"></div>
    <div id="peoples"></div>
</div>

<script type="text/template" id="visitorTemplate">
      <td>{{id}}</td>
      <td class="edit" data-visitor="name">{{name}}</td>
      <td><img src="{{photo}}" alt="" class="photo"></td>
      <td data-visitor="visit">{{visit}}</td>
      <td>{{personal}}</td>
      <td>{{date}}</td>
</script>
<script type="text/template" id="allVisitorsTemplate">
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>id</th><th>name</th><th>photo</th><th>visit</th><th>personal</th><th>date</th>
            </tr>
        </thead>
    </table>
</script>

<script src="js/peoples.js"></script>
<script src="js/main.js"></script>
<script>

    function setRandomData() {

        var randomNum = Math.round((Math.random() * 5));
        var newVisitor = true;
        var date = new Date();
        var VisitTime = function(date) {
            this.hours = date.getHours();
            this.minutes = date.getMinutes();
            this.seconds = date.getSeconds();

            this.showVisitTime = function(){
                if(this.seconds < 10) {

                    this.seconds = '0' + this.seconds;

                } else if(this.hours < 10 ) {

                    this.hours = '0' + this.hours;

                } else if(this.minutes < 10) {

                    this.minutes = '0' + this.minutes;

                }
                return this.hours + " : " + this.minutes + " : " + this.seconds;
            }
        };

        var visitTime = new VisitTime(date);


        for(var i = 0; i < peoplesData.length; i++) {

            if(peoplesData[i]['id'] === randomNum) {
                newVisitor = false;

                break;
            }

        }

        if(newVisitor) {

            peoplesData.push({"id":randomNum,"name":"Name" + randomNum,"photo":"photos/photo.png","visit":0,"personal":0,"date": visitTime.showVisitTime()});
            cinema.modelVisitors.reload(peoplesData);
        } else if(peoplesData[randomNum]) {

            peoplesData[randomNum]['visit']++;

            cinema.modelVisitors.setData(randomNum, 'visit', peoplesData[randomNum]['visit']);
            cinema.modelVisitors.setData(randomNum, 'date', visitTime.showVisitTime());
        }

        cinema.viewChanging.init(randomNum);

        setTimeout(setRandomData, 2000);
    };

    setRandomData();
</script>
</body>
</html>